async function validerVendeur() {
    const numeroUtil = document.getElementById('sellerSelect').value;
    const password2 = document.getElementById('sellerPassword').value;
    const userId = localStorage.getItem('userId');

    if (numeroUtil === '0') {
        showToast('Veuillez sélectionner un vendeur', true);
        return;
    }
    if (!password2) {
        showToast('Veuillez entrer le mot de passe', true);
        return;
    }

    try {
        // Préparer les données pour validation côté serveur
        const testVenteData = {
            numero_table: 0,
            date_comande: new Date().toISOString(),
            payment_mode: 'espece',
            amount_paid: 0,
            numero_util: parseInt(numeroUtil),
            password2: password2,
            lignes: [{ numero_item: 0, quantite: 0, prixt: 0, remarque: 'test', prixbh: 0 }]
        };

        const response = await fetch(`${API_BASE_URL}/valider_vente`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-User-ID': userId
            },
            body: JSON.stringify(testVenteData)
        });

        if (!response.ok) {
            let errorText;
            try {
                errorText = await response.text();
            } catch {
                errorText = `Erreur serveur ${response.status}`;
            }
            throw new Error(errorText);
        }

        // Validation OK - mettre à jour l'UI et stockage local
        const selectedOption = document.getElementById('sellerSelect').options[document.getElementById('sellerSelect').selectedIndex];
        const sellerName = selectedOption.text;

        localStorage.setItem('selectedSeller', JSON.stringify({
            numero_util: numeroUtil,
            nom: sellerName
        }));
        localStorage.setItem('sellerPassword', password2);

        document.getElementById('selectedSellerName').textContent = sellerName;
        document.getElementById('headerSellerName').textContent = sellerName;
        document.getElementById('sellerPassword').disabled = true;
        document.getElementById('validateSellerButton').textContent = 'Changer de vendeur';
        document.getElementById('validateSellerButton').onclick = changeAndValidateSeller;
        document.getElementById('sellerContent').classList.add('hidden');
        document.getElementById('sellerChevron').classList.add('fa-chevron-down');
        document.getElementById('sellerChevron').classList.remove('fa-chevron-up');
        showToast(`Vendeur ${sellerName} validé`);
    } catch (error) {
        showToast(`Erreur validation vendeur: ${error.message}`, true);
        console.error('Erreur validation:', error);
    }
}
